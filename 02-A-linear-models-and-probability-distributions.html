<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Review of linear models, probability distributions</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Exploration
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-A-data-exploration.html">Lab</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Linear Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="02-A-linear-models-and-probability-distributions.html">Lab</a>
    </li>
    <li>
      <a href="02-B-Homework-01.html">Homework 1</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Model Selection
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="03-A-model-selection.html">Lab</a>
    </li>
    <li>
      <a href="03-B-Homework-02.html">Homework 2</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Autocorrelation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04-A-Autocorrelation.html">Lab</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mixed Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="05-A-Linear-Mixed-Models.html">Lab: Linear Mixed Models</a>
    </li>
    <li>
      <a href="05-B-Generalized-Linear-Mixed-Models.html">Lab: Generalized Linear Mixed Models</a>
    </li>
    <li>
      <a href="05-C-Homework-03.html">Homework 3</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    HGAMs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06-A-Hierarchical-Generalized-Additive-Models.html">Lab: HGAMs</a>
    </li>
    <li>
      <a href="06-B-Homework-04.html">Homework 4</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Hello, Bayes!
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="07-A-Homework-05.html">Homeork 5</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Review of linear models, probability
distributions</h1>

</div>


<p><strong>Assigned Reading:</strong></p>
<ul>
<li>Guthery, Fred S., and Ralph L. Bingham. “A primer on interpreting
regression models.” The Journal of Wildlife Management 71.3 (2007):
684-692.</li>
<li><em>Chapter 3 of</em> Hobbs, N. T., &amp; Hooten, M. B. (2015).
Bayesian models: a statistical primer for ecologists. Princeton
University Press.</li>
</ul>
<!-- > Appendix A from: Zuur, A. F., Ieno, E. N., Walker, N., Saveliev, A. A. and Smith, G. M. 2009. *Mixed Effects Models and Extensions in Ecology with R.* Springer. [Here's the whole book](https://link-springer-com.stanford.idm.oclc.org/book/10.1007%2F978-0-387-87458-6) or [you can download just the appendix](https://link.springer.com/content/pdf/bbm%3A978-0-387-87458-6%2F1.pdf). -->
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>We will be reviewing linear models (linear regression) using the <a
href="https://allisonhorst.github.io/palmerpenguins/">Palmer
Penguins</a> dataset and R Package. We will start with generating
hypotheses, then move on to data exploration, fitting our first model,
checking that our model fits linear regression assumptions, and finally
interpreting our model. Meet the penguin species that we’ll be working
with:</p>
<p>
<div class="float">
<img
src="https://github.com/LivingLandscapes/Course_EcologicalModeling/raw/master/images/penguins.png"
width="300" alt="Artwork by @allison_horst" />
<div class="figcaption">Artwork by <span
class="citation">@allison_horst</span></div>
</div>
<p>
<p>Let’s get started!</p>
<hr />
</div>
<div id="linear-modeling-example" class="section level1">
<h1>Linear modeling example</h1>
<div id="data-exploration" class="section level2">
<h2>Data exploration</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># List of packages necessary to run this script:</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">require</span>(librarian, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">shelf</span>(tidyverse, cowplot, palmerpenguins, performance, bslib, shiny,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>      ggExtra,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># # Here is the link to the R Package with the penguins data:</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># https://allisonhorst.github.io/palmerpenguins/</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Read in a data file</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="fu">data</span>(<span class="at">package =</span> <span class="st">&#39;palmerpenguins&#39;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Take a look at the data. The head() function is good for this. On
your own, try the str() function on the entire data.frame, the range()
function on individual <em>numeric</em> columns, and the unique()
function on <em>character</em> columns.</p>
<p>Note: there are two datasets included in the “palmerpenguins”
package. We will use the cleaned ‘penguins’ dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">head</span>(penguins)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
## 1 Adelie  Torgersen           39.1          18.7               181        3750
## 2 Adelie  Torgersen           39.5          17.4               186        3800
## 3 Adelie  Torgersen           40.3          18                 195        3250
## 4 Adelie  Torgersen           NA            NA                  NA          NA
## 5 Adelie  Torgersen           36.7          19.3               193        3450
## 6 Adelie  Torgersen           39.3          20.6               190        3650
## # ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<p>Try out some data exploration techniques that we’ve learned. Here,
I’ve plotted histograms of body mass by species by island. <strong>On
your own, look for outliers, make scatterplots, and whatever else you
want to try.</strong></p>
<pre><code>## Warning: Removed 2 rows containing non-finite outside the scale range
## (`stat_bin()`).</code></pre>
<p><img src="02-A-linear-models-and-probability-distributions_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="lets-try-a-model" class="section level2">
<h2>Let’s try a model!</h2>
<p>A pretty reasonable hypothesis to test is <em>“In penguins, males
will have greater body mass than females, and body mass is also
allometrically related to bill length and depth.”</em> We could also add
that <em>“body mass will vary across species.”</em></p>
<p>To test this hypothesis, let’s create a ‘global’ model containing all
the variables that our hypotheses predict will influence body mass:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># fit the global linear regression</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>fit_global <span class="ot">&lt;-</span> </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> sex <span class="sc">+</span> bill_length_mm <span class="sc">*</span> bill_depth_mm <span class="sc">+</span> species,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>     <span class="at">data =</span> penguins)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># Check out the global model&#39;s coefficients, R^2 values, and p-values.</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">summary</span>(fit_global)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = body_mass_g ~ sex + bill_length_mm * bill_depth_mm + 
##     species, data = penguins)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -787.41 -179.56   -6.98  199.41  904.99 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  -3184.722   1833.850  -1.737  0.08340 .  
## sexmale                        440.126     48.824   9.014  &lt; 2e-16 ***
## bill_length_mm                 121.948     42.986   2.837  0.00484 ** 
## bill_depth_mm                  315.022    102.849   3.063  0.00237 ** 
## speciesChinstrap              -201.897     86.241  -2.341  0.01983 *  
## speciesGentoo                 1379.565    110.804  12.451  &lt; 2e-16 ***
## bill_length_mm:bill_depth_mm    -5.386      2.392  -2.251  0.02503 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 298 on 326 degrees of freedom
##   (11 observations deleted due to missingness)
## Multiple R-squared:  0.8655, Adjusted R-squared:  0.8631 
## F-statistic: 349.7 on 6 and 326 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We did it! On your own, please go line-by-line through the summary
table and–in words–communicate to yourself and/or your neighbors if each
hypothesis is supported and why.</p>
<p>Additionally, you may be asking a common question for folks using
categorical variables in regression. In this case, it’s probably “why
are there no coefficient estimates for sex:female or species:Adelie?” On
your own, search Google and/or StackOverflow for an answer.</p>
<div id="collinearity" class="section level3">
<h3>Collinearity?</h3>
<p>But wait–we forgot a critical step: checking for collinearity in the
predictor variables! Now that we have a fitted model, we can use VIFs to
assess collinearity:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Use performance::check_collinearity to calculate VIFs:</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">check_collinearity</span>(fit_global)</span></code></pre></div>
<pre><code>## Model has interaction terms. VIFs might be inflated.
##   You may check multicollinearity among predictors of a model without
##   interaction terms.</code></pre>
<pre><code>## # Check for Multicollinearity
## 
## Low Correlation
## 
##  Term  VIF       VIF 95% CI Increased SE Tolerance Tolerance 95% CI
##   sex 2.23 [  1.92,   2.66]         1.49      0.45     [0.38, 0.52]
## 
## High Correlation
## 
##                          Term    VIF       VIF 95% CI Increased SE Tolerance
##                bill_length_mm 206.62 [167.80, 254.47]        14.37  4.84e-03
##                 bill_depth_mm 153.38 [124.59, 188.87]        12.38  6.52e-03
##                       species  28.03 [ 22.85,  34.43]         5.29      0.04
##  bill_length_mm:bill_depth_mm 287.47 [233.43, 354.09]        16.96  3.48e-03
##  Tolerance 95% CI
##      [0.00, 0.01]
##      [0.01, 0.01]
##      [0.03, 0.04]
##      [0.00, 0.00]</code></pre>
<p>Uh oh. Looks like we have &gt;&gt;&gt; 10 VIFs for all predictor
variables except sex! Are our species and allometric hypotheses
scuppered?!</p>
<p>Before we get too morose, let’s try a few things to double-check
these VIFs are giving us accurate information. First, it stands to
reason that if we have interaction terms such as ‘x’, ‘y’ and ‘xy,’ then
‘x’ and ‘y’ will be correlated with their product ‘xy,’ right? One way
to demonstrate this is by standardizing (i.e., centering or scaling) the
offending numeric predictor variables and recalculating VIFs. This
should reduce the collinearity at least for the interaction terms. Let’s
try it:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Create a new data.frame with </span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  penguins <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(bill_length_mm, bill_depth_mm),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                <span class="at">.fns =</span> <span class="cf">function</span>(X) <span class="fu">as.numeric</span>(<span class="fu">scale</span>(X)),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                <span class="at">.names =</span> <span class="st">&quot;{.col}_scaled&quot;</span>))</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># fit the global linear regression</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>fit_global_scaled <span class="ot">&lt;-</span> </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> sex <span class="sc">+</span> bill_length_mm_scaled <span class="sc">*</span> bill_depth_mm_scaled <span class="sc">+</span> species,</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>     <span class="at">data =</span> penguins)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co"># Use performance::check_collinearity to calculate VIFs:</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">check_collinearity</span>(fit_global_scaled)</span></code></pre></div>
<pre><code>## Model has interaction terms. VIFs might be inflated.
##   You may check multicollinearity among predictors of a model without
##   interaction terms.</code></pre>
<pre><code>## # Check for Multicollinearity
## 
## Low Correlation
## 
##                                        Term  VIF     VIF 95% CI Increased SE
##                                         sex 2.23 [ 1.92,  2.66]         1.49
##  bill_length_mm_scaled:bill_depth_mm_scaled 1.75 [ 1.53,  2.07]         1.32
##  Tolerance Tolerance 95% CI
##       0.45     [0.38, 0.52]
##       0.57     [0.48, 0.65]
## 
## Moderate Correlation
## 
##                   Term  VIF     VIF 95% CI Increased SE Tolerance
##  bill_length_mm_scaled 6.00 [ 4.97,  7.29]         2.45      0.17
##   bill_depth_mm_scaled 6.11 [ 5.07,  7.43]         2.47      0.16
##  Tolerance 95% CI
##      [0.14, 0.20]
##      [0.13, 0.20]
## 
## High Correlation
## 
##     Term   VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
##  species 28.03 [22.85, 34.43]         5.29      0.04     [0.03, 0.04]</code></pre>
<p>Okay, so far so good. The second thing to check is whether
coefficient, p-values, and <span class="math inline">\(R^2\)</span>
values have changed between the un-standardized global model and the
standardized global model. Run this block on your own and see what
happens:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Compare coefficients and p-values.</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">summary</span>(fit_global)<span class="sc">$</span>coefficients <span class="co"># Note: summary() creates a list that you can index for specific model information.</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">summary</span>(fit_global_scaled)<span class="sc">$</span>coefficients</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Compare R^2 values</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">summary</span>(fit_global)<span class="sc">$</span>adj.r.squared</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="fu">summary</span>(fit_global_scaled)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<p>Great! Both our expectations for the interaction terms were
confirmed, and we don’t need to worry about high VIFs there.</p>
<p>However, we still need to deal with the &gt; 10 VIF for species,
which does appear to be accurate. Fortunately, the answer is simple:
drop the species variable from the model and recheck for collinearity.
On your own, consider model outputs from the code chunk below and
compare these to previous model outputs:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># fit the global linear regression</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>fit_global_scaled_noSpecies <span class="ot">&lt;-</span> </span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> sex <span class="sc">+</span> bill_length_mm_scaled <span class="sc">*</span> bill_depth_mm_scaled,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>     <span class="at">data =</span> penguins)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co"># Check collinearity</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">check_collinearity</span>(fit_global_scaled_noSpecies)</span></code></pre></div>
<pre><code>## # Check for Multicollinearity
## 
## Low Correlation
## 
##                                        Term  VIF   VIF 95% CI Increased SE
##                                         sex 1.65 [1.45, 1.94]         1.28
##                       bill_length_mm_scaled 1.69 [1.48, 1.99]         1.30
##                        bill_depth_mm_scaled 1.63 [1.43, 1.91]         1.28
##  bill_length_mm_scaled:bill_depth_mm_scaled 1.29 [1.17, 1.52]         1.14
##  Tolerance Tolerance 95% CI
##       0.61     [0.52, 0.69]
##       0.59     [0.50, 0.67]
##       0.61     [0.52, 0.70]
##       0.77     [0.66, 0.86]</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Check out the global model&#39;s coefficients, R^2 values, and p-values.</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">summary</span>(fit_global_scaled_noSpecies)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = body_mass_g ~ sex + bill_length_mm_scaled * bill_depth_mm_scaled, 
##     data = penguins)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1382.55  -264.66    -9.64   246.14  1268.04 
## 
## Coefficients:
##                                            Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                                 3755.42      35.23 106.612   &lt;2e-16
## sexmale                                      770.97      57.12  13.497   &lt;2e-16
## bill_length_mm_scaled                        313.58      28.95  10.832   &lt;2e-16
## bill_depth_mm_scaled                        -411.92      28.51 -14.446   &lt;2e-16
## bill_length_mm_scaled:bill_depth_mm_scaled  -270.09      30.19  -8.946   &lt;2e-16
##                                               
## (Intercept)                                ***
## sexmale                                    ***
## bill_length_mm_scaled                      ***
## bill_depth_mm_scaled                       ***
## bill_length_mm_scaled:bill_depth_mm_scaled ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 406.2 on 328 degrees of freedom
##   (11 observations deleted due to missingness)
## Multiple R-squared:  0.7486, Adjusted R-squared:  0.7455 
## F-statistic: 244.2 on 4 and 328 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="model-diagnostics" class="section level3">
<h3>Model diagnostics</h3>
<p>As a last step, we need to make sure our final model meets all
required assumptions for a linear regression:</p>
<ul>
<li>Linear relationship between response and predictor variables</li>
<li>Reasonable levels of collinearity (e.g., VIF &lt; 3 or 5 or 10)</li>
<li>Homogeneity of variances between groups (i.e., homoscedasticity
[i.e., NOT heteroscedasticity])</li>
<li>Errors are normally distributed</li>
<li>Independent sampling (i.e., no autocorrelation or
pseudoreplication)</li>
</ul>
<p>We’ve already dealt with collinearity, we know there is a linear
relationship between response and predictor variables. On your own, go
back through our previous work to determine where and how we checked for
collinearity and the linear relationship–and what the outcomes were.</p>
<p>We will wait until our Autocorrelation topic to check for
independence, but we let’s definitely check for homogeneity of variances
and normal error distributions:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Check for heteroscedasticity via the fancy ggplot2 way of plotting fitted values vs. residuals:</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> fit_global_scaled_noSpecies<span class="sc">$</span>fitted.values,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                 <span class="at">y =</span> fit_global_scaled_noSpecies<span class="sc">$</span>residuals)) <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Fitted values&quot;</span>) <span class="sc">+</span> </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Residuals&quot;</span>)</span></code></pre></div>
<p><img src="02-A-linear-models-and-probability-distributions_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Built-in model diagnostics for checking for heteroscedasticity, errors are normally distributed, etc.</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) <span class="co"># To make all plots be panels of a single figure. </span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">plot</span>(fit_global_scaled_noSpecies)</span></code></pre></div>
<p><img src="02-A-linear-models-and-probability-distributions_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>So our final model contains sex and an interaction of bill length and
depth to explain body mass in penguins. We’ve successfully created our
first linear model!</p>
</div>
</div>
<div id="discussion-questions" class="section level2">
<h2>Discussion Questions</h2>
<ol style="list-style-type: decimal">
<li><p>If we were writing a manuscript based on our final model (and
assuming we designed the study with the hypotheses we generated), how
would we interpret the fact that we dropped the ‘species’ predictor
variable from the final model?</p></li>
<li><p>Interpreting interaction terms simply is tricky from the
coefficients. How could we create a plot to help us? HINT: 1) Use
expand.grid() to create a new data.frame based on the range of values of
each predictor variable, 2) then use predict(), 3) then plot the
predicted relationships.</p></li>
<li><p>Graphically, how can we characterize uncertainty in our model?
HINT: look at the predict() “se.fit” argument.</p></li>
<li><p>Using words only, interpret our final model.</p></li>
</ol>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
